秒杀活动场景
===========

淘宝双11秒杀，瞬间流量巨大，秒杀活动考验后台数据库，缓存服务的业务

秒杀技术挑战
--------
	突增的服务器及网络需求
	
		服务器使用是平时的3-5倍，网络带宽是n倍
		
	业务高并发，服务负载重
	
		Web系统的吞吐率指标是QPS，解决每秒数万次的高并发场景，这个指标很关键
	处理一个业务请求评价响应时间100ms，同时系统内有20台web服务器，配置最大连接数500个
	web系统理论峰值QPS为100000，意味着一秒钟可以处理完10w的请求，秒杀的5w/s是为纸老虎
		实际情况下，在高并发场景，服务器处于高负载状态，网络带宽被挤满，在这个时候平静
	响应时间会被大大增加，随着用户数量的增加，数据库连接进程增加，需要处理的上下文切换
	也越多，服务器造成的负载压力越来越重。
		
	业务耦合度高，引起系统雪崩
	
		系统某个应用因为延迟变得不可用，用户请求频繁，恶性循环导致雪崩，一台服务器挂了
		流量分散到其他正常工作的机器上，再导致其它正常机器也挂了，然后恶性循环，拖垮整
		个系统。
		
解决秒杀技术瓶颈
---------

## 秒杀架构设计思路
		将请求拦截在系统上游，降低下游压力，秒杀系统并发量极大，实际成功请求数量很小，前端
	拦截很可能造成数据库读写锁冲突，甚至导致死锁，最终请求超时。
		充分利用缓存redis，极大提高系统读写速度
		消息中间件可以削峰，将拦截大量并发请求，这是异步处理的过程，后台业务根据自己的处理
	能力，从消息队列中主动拉取请求进行业务处理。
## 前端设计方案
		页面静态化：将活动页面所有可以静态的元素都静态化，减少动态元素CDN抗峰值
		禁止重复提交：按钮置灰
		用户限流：一个时间段只允许一次提交，ip限流等
## 后端设计方案
		服务端控制器层（网关层）
		限制uid访问频率
		服务层
		采用消息队列缓存请求
		利用缓存应对读请求
		利用缓存应对写请求
## 数据库层
	最脆弱的一层 只能承担能力范围内的访问请求。

	利用消息中间件和缓存实现简单秒杀系统
	

# 秒杀架构设计总结
	限流： 鉴于只有少部分用户能够秒杀成功，限制大部分流量，只允许少部分流量进入服务后端
	削峰：高峰值是压垮系统的重要原因，将瞬间高流量变成平稳的流量也是重要思路，比如使用
	缓存和消息中间件
	异步处理：秒杀系统是一个高并发系统，采用异步处理模式可以极大提高系统并发量。（削峰）
	内存缓存：数据库读写属于磁盘io，性能很低，把部分数据或业务逻辑转移到内存缓存，效率
	极大地提高
	可拓展：系统设计成弹性可拓展的，如果流量来了，拓展机器就好了。
